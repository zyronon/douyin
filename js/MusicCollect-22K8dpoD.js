import{u as E,l as i,m as d,n as f}from"./other-gs8SHhrM.js";import{u as N,H as g,g as u,v as r,f as C,_ as B}from"./common-B2Q_mKBS.js";import"./vendor-CjFJgEVW.js";const I={class:"MusicCollect"},w={class:"content"},D={class:"list"},M=["onClick"],x={class:"music"},L={class:"cover-wrapper"},S={alt:"",class:"cover"},b={key:0,src:i,alt:"",class:"play"},z={key:1,src:d,alt:"",class:"play"},T={class:"desc"},$={class:"name"},H={class:"author"},P={class:"desc-bottom"},U={class:"duration"},A={class:"option"},F=["onClick"],W={key:0,class:"float-play-music"},j={class:"music-wrapper"},q={class:"music"},G={alt:"",class:"cover"},J={key:0,src:i,alt:"",class:"play"},K={key:1,src:d,alt:"",class:"play"},O={class:"desc"},Q={class:"name"},R={class:"desc-bottom"},X={class:"duration"},Y={class:"option"},Z=Vue.defineComponent({name:"MusicCollect",__name:"MusicCollect",setup(ee){const V=N(),m=E(),e=Vue.reactive({loading:!1,list:[],audio:new Audio,currentItem:null,step:null,process:0});Vue.onMounted(()=>{_(),e.audio.addEventListener("loadedmetadata",()=>{e.currentItem.duration=e.audio.duration,e.step=V.bodyWidth/Math.floor(e.audio.duration)}),e.audio.addEventListener("timeupdate",t=>{e.process=Math.ceil(t.target.currentTime)*e.step})}),Vue.onUnmounted(c);async function _(){e.loading=!0;let t=await g();e.loading=!1,t.success&&(e.list=t.data.music.list)}function a(t,s){s.map(n=>{n.name!==t.name&&(n.is_play=!1)}),t.is_play=!t.is_play,t.is_play?(e.currentItem?e.currentItem.name!==t.name&&(e.audio.pause(),e.audio.src=t.mp3,e.audio.currentTime=0):(e.audio.pause(),e.audio.src=t.mp3,e.audio.currentTime=0),e.audio.play(),e.audio.addEventListener("ended",()=>t.is_play=!1)):c(),e.currentItem=t}function c(){e.audio.pause(),e.audio.removeEventListener("ended",null)}return(t,s)=>{const n=Vue.resolveComponent("BaseHeader"),p=Vue.resolveComponent("Loading"),v=Vue.resolveComponent("no-more"),y=Vue.resolveComponent("dy-button"),l=Vue.resolveDirective("lazy");return Vue.openBlock(),Vue.createElementBlock("div",I,[Vue.createVNode(n,null,{center:Vue.withCtx(()=>s[1]||(s[1]=[Vue.createElementVNode("span",{class:"f16"},"音乐收藏",-1)])),_:1}),Vue.createElementVNode("div",w,[Vue.createElementVNode("div",D,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.list,(o,k)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"item",key:k,onClick:h=>a(o,e.list)},[Vue.createElementVNode("div",x,[Vue.createElementVNode("div",L,[Vue.withDirectives(Vue.createElementVNode("img",S,null,512),[[l,Vue.unref(u)(o.cover)]]),o.is_play?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createElementBlock("img",b)),o.is_play?(Vue.openBlock(),Vue.createElementBlock("img",z)):Vue.createCommentVNode("",!0)]),Vue.createElementVNode("div",T,[Vue.createElementVNode("span",$,Vue.toDisplayString(o.name),1),Vue.createElementVNode("div",H,Vue.toDisplayString(o.author),1),Vue.createElementVNode("div",P,[Vue.createElementVNode("div",U,Vue.toDisplayString(Vue.unref(r)(o.duration)),1)])])]),Vue.createElementVNode("div",A,[Vue.createElementVNode("img",{src:f,alt:"",onClick:Vue.withModifiers(h=>Vue.unref(m)("/home/music",o),["stop"])},null,8,F)])],8,M))),128))]),e.loading?(Vue.openBlock(),Vue.createBlock(p,{key:0,"is-full-screen":!1})):(Vue.openBlock(),Vue.createBlock(v,{key:1,class:"mb7r"}))]),e.currentItem?(Vue.openBlock(),Vue.createElementBlock("div",W,[Vue.createElementVNode("div",{class:"process",style:Vue.normalizeStyle({width:e.process+"px"})},null,4),Vue.createElementVNode("div",j,[Vue.createElementVNode("div",q,[Vue.createElementVNode("div",{class:"cover-wrapper",onClick:s[0]||(s[0]=o=>a(e.currentItem,e.list))},[Vue.withDirectives(Vue.createElementVNode("img",G,null,512),[[l,Vue.unref(u)(e.currentItem.cover)]]),e.currentItem.is_play?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createElementBlock("img",J)),e.currentItem.is_play?(Vue.openBlock(),Vue.createElementBlock("img",K)):Vue.createCommentVNode("",!0)]),Vue.createElementVNode("div",O,[Vue.createElementVNode("span",Q,Vue.toDisplayString(e.currentItem.name),1),Vue.createElementVNode("div",R,[Vue.createElementVNode("div",X,Vue.toDisplayString(Vue.unref(r)(e.currentItem.duration)),1)])])]),Vue.createElementVNode("div",Y,[Vue.createVNode(y,{type:"primary",size:"small",onClick:Vue.unref(C)},{default:Vue.withCtx(()=>s[2]||(s[2]=[Vue.createTextVNode("使用")])),_:1,__:[2]},8,["onClick"])])])])):Vue.createCommentVNode("",!0)])}}}),ne=B(Z,[["__scopeId","data-v-d326a640"]]);export{ne as default};
